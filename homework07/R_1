'''1. Сколько мужчин и женщин (признак sex) представлено в этом наборе данных?'''
table(df$sex)

'''2. Каков средний возраст (признак age) женщин?'''
mean(df[df['sex'] == 'Female', 'age'])

'''3. Какова доля граждан Германии (признак native-country)?'''
 prop.table(table(df$native.country))['Germany']

'''4-5. Каковы средние значения и среднеквадратичные отклонения возраста тех, 
кто получает более 50K в год (признак salary) и тех, кто получает менее 50K в год?'''

library(dplyr)
df %>% group_by(salary) %>%
  summarise(n = n(),
            mean = mean(age),
            std = sd(age))

'''6. Правда ли, что люди, которые получают больше 50k, имеют как минимум высшее образование? 
(признак education – Bachelors, Prof-school, Assoc-acdm, Assoc-voc, Masters или Doctorate)'''

table(df$education, df$salary)
addmargins(table(df$education, df$salary))
prop.table(table(df$education, df$salary))

'''7. Выведите статистику возраста для каждой расы (признак race) и каждого пола.
Используйте groupby и describe. Найдите таким образом максимальный возраст мужчин расы Amer-Indian-Eskimo.'''
races = unique(df$race)
len = length(races)
for(i in 1:len){
	result1 = summary(df[df$sex == 'Male' & df$race == races[i], 'age'])
	result2 = summary(df[df$sex == 'Female' & df$race == races[i], 'age'])
	print(races[i])
	print(result1)
	print(result2)
}
summary(df[df$sex == 'Male' & df$race == "Amer-Indian-Eskimo", 'age'])

'''8. Среди кого больше доля зарабатывающих много (>50K): среди женатых или холостых мужчин (признак marital-status)?
Женатыми считаем тех, у кого marital-status начинается с Married (Married-civ-spouse, Married-spouse-absent или Married-AF-spouse), 
остальных считаем холостыми.'''
table(df$marital.status, df$salary)
addmargins(table(df$marital.status, df$salary))
prop.table(table(df$marital.status, df$salary))


'''9. Какое максимальное число часов человек работает в неделю (признак hours-per-week)? 
Сколько людей работают такое количество часов и каков среди них процент зарабатывающих много?'''

max(df$hours.per.week)
count(df$hours.per.week, vars = 99)

newdata <- subset(df, hours.per.week == 99, hours.per.week)
count(newdata)

table(df$hours.per.week == 99, df$salary)
addmargins(table(df$hours.per.week == 99, df$salary))
prop.table(table(df$hours.per.week == 99, df$salary))


'''10. Посчитайте среднее время работы (hours-per-week) зарабатывающих мало и много (salary) для каждой страны (native-country).' ''
countries = unique(df$native.country)
len = length(countries)
for(i in 1:len){
	result1 = mean(df$hours.per.week[df$salary == '>50K' & df$native.country == countries[i]])
	result2 = mean(df$hours.per.week[df$salary == '<=50K' & df$native.country == countries[i]])
	print(countries[i])
	print(result1)
	print(result2)
}
